<?phpnamespace common\models\score;use common\models\user\User;use Yii;/** * This is the model class for table "score_invest". * * @property int $id * @property int $user_id * @property double $fund */class ScoreInvest extends \yii\db\ActiveRecord{    /**     * @inheritdoc     */    public static function tableName()    {        return 'score_invest';    }    /**     * @inheritdoc     */    public function rules()    {        return [            [['user_id'], 'integer'],            [['fund'], 'number'],        ];    }    /**     * @inheritdoc     */    public function attributeLabels()    {        return [            'id' => 'ID',            'user_id' => '投资者ID',            'fund' => '资金',        ];    }    /**     * 添加投资记录前，扣除用户余额     * @param bool $insert     * @return bool     */    public function beforeSave($insert)    {        //添加投资记录前，扣除用户余额        if($insert){            $user = User::findOne($this->user_id);            $this->fund = ($user->fund >= $this->fund) ? $this->fund : $user->fund;            $user->fund = $user->fund - $this->fund;            $user->save();        }        return parent::beforeSave($insert); // TODO: Change the autogenerated stub    }}